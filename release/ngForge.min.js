/*!
 * Copyright 2015 Thinking Bytes Ltd.
 *
 * ngForge, v0.2.3
 * Angular wrappers for Trigger.io (forge) modules.
 * http://trigger.io/
 * http://angularjs.org/
 *
 * By @arolave <3
 *
 * Licensed under the MIT license. Please see LICENSE for more information.
 *
 */

!function(){angular.module("ngForge",[]),angular.module("ngForge").provider("$forge",function(){return{testConnectionUrl:"ping",$get:["$http","$interval","$window","$forgeLogger",function(e,n,r,t){var o=this,i={dummy:!0,is:{web:function(){return!0},mobile:function(){return!1},android:function(){return!1},ios:function(){return!1},orientation:{portrait:function(){return!0},landscape:function(){return!1}},connection:{_connected:!1,connected:function(){return this._connected},wifi:function(){return this._connected}}},event:{menuPressed:{addListener:function(e,n){return void 0}},backPressed:{addListener:function(e,n){return void 0},preventDefault:function(e,n){return void 0}},orientationChange:{addListener:function(e,n){return void 0}},connectionStateChange:{listeners:[],addListener:function(e,n){return void this.listeners.push(e)}},messagePushed:{addListener:function(e,n){return void 0}},appPaused:{addListener:function(e,n){return void 0}},appResumed:{addListener:function(e,n){return void 0}},statusBarTapped:{addListener:function(e,n){return void 0}}},tools:{UUID:function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},getURL:function(e,n,r){n(e)}},testConnection:function(){var n;return n=function(e){return function(n){return e.is.connection._connected=n,e.event.connectionStateChange.listeners.forEach(function(e){return e()})}}(this),e.get(o.testConnectionUrl).then(function(e){return function(){return e.is.connection._connected?void 0:n(!0)}}(this))["catch"](function(e){return function(){return e.is.connection._connected?n(!1):void 0}}(this))}};return r.forge?(t.info("ngForge.$forge: using trigger.io"),r.forge):(t.info("ngForge.$forge: using dummy"),i.testConnection(),n(function(){return i.testConnection()},5e3),i)}]}}),angular.module("ngForge").provider("$forgeCamera",function(){"use strict";return{$get:["$forge","ngForgeUtils",function(e,n){var r={getImage:function(){return success=n.isFunction(arguments[0])?arguments[0]:arguments[1],success()}};return n.liftObject(e.dummy?r:forge.camera)}]}}),angular.module("ngForge").provider("$forgeContact",function(){"use strict";return{$get:["$injector","$q","$forge","$forgeLogger","ngForgeUtils",function(e,n,r,t,o){var i=this,u={select:function(e,n){return t.debug("select"),"function"==typeof e?e():void 0},selectAll:function(e,n,r){return o.isFunction(e)&&(e=["id","displayName"],n=e,r=n),t.debug("selectAll"),"function"==typeof n?n(i.sampleContacts.map(function(n){return o.pick(n,e)})):void 0},selectById:function(e,n,r){return t.debug("selectById"),"function"==typeof n?n(o.find(i.sampleContacts,function(n){return n.id===e})):void 0}};return o.liftObject(r.dummy?u:forge.contact)}],sampleContacts:[{id:"14894",displayName:"Gal Gadot",name:{formatted:"Gal Gadot",familyName:"Gadot",givenName:"Gal",middleName:null,honorificPrefix:"",honorificSuffic:null},nickname:"",phoneNumbers:[{value:"+447574712444",type:"mobile",pref:!1}],photos:[{value:"data:image/jpg;base64,ABCDEF1234",type:null,pref:!1}]},{id:"148900",displayName:"Tom",name:{formatted:"Tom",familyName:"",givenName:"Tom",middleName:null,honorificPrefix:"",honorificSuffic:null},nickname:"",phoneNumbers:[{value:"+44 751-5097756+13",type:"mobile",pref:!1}],photos:[{value:"data:image/jpg;base64,ABCDEF1234",type:null,pref:!1}]},{id:"14894",displayName:"Brigid",name:{formatted:"Brigid",familyName:"",givenName:"Brigid",middleName:null,honorificPrefix:"",honorificSuffic:null},nickname:"",phoneNumbers:[{value:"+33 7817471244",type:"mobile",pref:!1}],photos:[{value:"data:image/jpg;base64,ABCDEF1234",type:null,pref:!1}]},{id:"14895",displayName:"Eddie Redmayne",name:{formatted:"Eddie Redmayne",familyName:"Fenech",givenName:"Eddie",middleName:null,honorificPrefix:"",honorificSuffic:null},nickname:"",phoneNumbers:[{value:"+447432111412",type:"mobile",pref:!1}],photos:[{value:"data:image/jpg;base64,ABCDEF1234",type:null,pref:!1}]},{id:"122",displayName:"Arow",name:{formatted:"Arow",familyName:"Arow"},nickname:"",phoneNumbers:[{value:"+972 963587331",type:"mobile",pref:!1}]},{id:"299",displayName:"Bad Phone",name:{formatted:"Bad Phone",familyName:"BPhone"},nickname:"",phoneNumbers:[{value:"+97288898",type:"mobile",pref:!1}]},{id:"1",displayName:"Girt Wenders",name:{formatted:"Girt Wenders",familyName:"Wenders",givenName:"Girt",middleName:null,honorificPrefix:"",honorificSuffic:null},nickname:"",phoneNumbers:[{value:"+972 521123241",type:"mobile",pref:!1}]},{id:"690",displayName:"Dodgy Bro",name:{formatted:"Dodgy Bro",familyName:"Bro",givenName:"Dodgy",middleName:null,honorificPrefix:"",honorificSuffic:null},nickname:"Doge",phoneNumbers:[{value:"+44 7967929796",type:"mobile",pref:!1}]},{id:"691",displayName:"Toby Bro",name:{formatted:"Toby Bro",familyName:"Bro",givenName:"Toby",middleName:null,honorificPrefix:"",honorificSuffic:null},nickname:"Tobe",phoneNumbers:[{value:"+44-783-241324",type:"work",pref:!1}]},{id:"2",displayName:"Mr Bodie Carstairs",name:{formatted:"Bodie Carstairs",familyName:"Carstairs",givenName:"Bodie",middleName:null,honorificPrefix:"",honorificSuffic:null},nickname:"Bo",phoneNumbers:[{value:"+447321123324",type:"mobile",pref:!1}],photos:[{value:"data:image/jpg;base64,ABCDEF1234",type:null,pref:!1}]},{id:"3",displayName:"Lucy Cleaner 45",name:{formatted:"Lucy Cleaner 45",familyName:"Cleaner",givenName:"Lucy",middleName:"middle",honorificPrefix:"",honorificSuffic:null},nickname:"",phoneNumbers:[{value:"+447321132131",type:"mobile",pref:!1}],photos:[{value:"data:image/jpg;base64,ABCDEF1234",type:null,pref:!1}]},{id:"33",displayName:"Ches ;",name:{formatted:"Ches",familyName:"",givenName:"Ches",middleName:"",honorificPrefix:"",honorificSuffic:null},nickname:"",phoneNumbers:[{value:"0543742342",type:"mobile",pref:!1}],photos:[{value:"data:image/jpg;base64,ABCDEF1234",type:null,pref:!1}]},{id:"4",displayName:"Sarah",name:{formatted:"Sarah",familyName:"",givenName:"Sarah",middleName:null,honorificPrefix:"",honorificSuffic:null},nickname:"tush",phoneNumbers:[{value:"+972547434302",type:"work",pref:!1},{value:"+335723131231",type:"home",pref:!1},{value:"+447312311232",type:"mobile",pref:!1}],photos:[{value:"data:image/jpg;base64,ABCDEF1234",type:null,pref:!1}]},{id:"14",displayName:"הגית אלון",name:{formatted:"הגית אלון",familyName:"אלון",givenName:"הגית",middleName:null,honorificPrefix:"",honorificSuffic:null},phoneNumbers:[{value:"+972727474747",type:"home",pref:!1}],photos:[{value:"data:image/jpg;base64,ABCDEF1234",type:null,pref:!1}]}]}}),angular.module("ngForge").provider("$forgeFacebook",function(){"use strict";return{$get:["$injector","$forge","ngForgeUtils",function(e,n,r){var t=this,o={authorize:function(e,n,r,t){return r({access_token:"dfs",access_expires:"never",granted:!0,denied:!1})},hasAuthorized:function(e,n,r,t){return r({access_token:"dfs",access_expires:"never",granted:!1,denied:!1})},logout:function(e,n){return e()},api:function(e,n,r,t,o){return t(!0)},ui:function(e,n,r){return n(!0)},installed:function(e,n){return e(!0)},getKeyHash:function(e,n){return e(t.facebookKeyHash)}};return r.liftObject(n.dummy?o:forge.facebook)}],facebookKeyHash:"NteSLOyHHHx12WUnrW0NEbwcY2Y"}}),angular.module("ngForge").provider("$forgeFile",function(){"use strict";return{$get:["$injector","$q","$forge","ngForgeUtils",function(e,n,r,t){var o,i;return o={isFile:function(e,n){return n(!!(null!=e?e.uri:void 0))},getLocal:function(e,n){return n({uri:e})},cacheURL:function(e,n,r){return n({uri:e})},URL:function(e,n){return n(e.uri)},remove:function(e,n){return n()}},i=r.dummy?o:forge.file,t.liftObject(i)}]}}),angular.module("ngForge").provider("$forgeHttp",["$httpProvider",function(e){"use strict";return{$get:["$http","$injector","$q","$rootScope","$forge","$forgeLogger","ngForgeUtils",function(e,n,r,t,o,i,u){return o.dummy?this.ngHttp(e,i):this.forgeHttp(e,n,r,t,o,u,i)}],httpProvider:e,ngHttp:function(e,n){return n.debug("using $http for comms"),{request:function(n){return e(n)},get:function(r,t){return n.log("ngget:"+r),e.get(r,t)},jsonp:function(r,t){return n.log("ngjsonp:"+r),e.jsonp(r,t)},post:function(r,t,o){return n.log("ngpost:"+r+":"+t),e.post(r,t,o)},put:function(r,t,o){return n.log("ngput:"+r+":"+t),e.put(r,t,o)},"delete":function(r,t){return n.log("ngdelete:"+r),e["delete"](r,t)}}},forgeHttp:function(e,n,r,t,o,i,u){var a;return u.debug("using forge for comms"),a=[],angular.forEach(this.httpProvider.interceptors,function(e){return a.unshift(angular.isString(e)?n.get(e):n.invoke(e))}),{request:function(e){return this._basicRequest(e.method,e.url,e)},get:function(e,n){return this._getRequest(e,n)},post:function(e,n,r){return this._basicRequest("post",e,r,n)},put:function(e,n,r){return this._basicRequest("put",e,r,n)},patch:function(e,n,r){return this._basicRequest("patch",e,r,n)},"delete":function(e,n){return this._basicRequest("delete",e,n)},jsonp:function(e,n){return this._basicRequest("jsonp",e,n)},_getRequest:function(e,n){var t,o,a,f,c,s,g,l;if(u.info("_getRequest("+e+", "+JSON.stringify(n)+")"),a=r.defer(),s=a.promise,i.isObject(null!=n?n.cache:void 0)&&(t=null!=n?n.cache:void 0),c=function(e){return e>=200&&300>e},g=function(e,r,t,o){return r=Math.max(r,0),(c(r)?a.resolve:a.reject)({data:e,status:r,headers:t,config:n,statusText:o})},l=function(e){return g(e.data,e.status,i.safeClone(e.headers),e.statusText)},t){if(o=t.get(e),null!=o)return i.isFunction(o.then)?o.then(l,l):Array.isArray(o)?g(o[1],o[0],i.safeClone(o[2]),o[3]):g(o,200,{},"OK"),s;t.put(e,s)}return f=function(n){return t&&(c(n.status)?t.put(e,[n.status,n.data,n.headers,n.statusText]):t.remove(e)),l(n)},this._basicRequest("get",e,n).then(f,f),s},_forgeRequester:function(e){var n;return u.info("_forgeRequester"),n=r.defer(),e.success=function(r,o){return u.debug("ngForge.$forgeHttp.success: "+JSON.stringify(r)),n.resolve({status:200,data:r,headers:o,config:e}),t.$$phase?void 0:t.$apply()},e.error=function(e){var r,o;u.debug("error "+JSON.stringify(e)),u.error(e.statusCode+" "+e.content),o=400;try{o=parseInt(e.statusCode)}catch(i){}r=e.content;try{r=JSON.parse(e.content)}catch(i){}return n.reject({status:o,data:r,headers:{}}),t.$$phase?void 0:t.$apply()},forge.request.ajax(e),n.promise},_basicRequest:function(n,r,t,o){var i,u,a;return i=function(e,n){var r,t;return r=angular.extend(n||{},{contentType:"application/json; charset=utf-8",accepts:["application/json"],type:e.method.toUpperCase()}),e.file?r.files=[e.file]:r.dataType=e.responseType||"json",t=angular.extend(e||{},r),delete t.file,t},u=angular.extend(t||{},{method:n,url:r}),"jsonp"===n?e.jsonp(r,u):(a=o?{data:JSON.stringify(o)}:t&&t.params?{data:t.params}:void 0,this._doRequest(i(u,a)))},_doRequest:function(e){var n,t,o,i;for(u.log("$forge"+e.method.toLowerCase()+":"+e.url+":"+((null!=e?e.data:void 0)?JSON.stringify(e.data):void 0)),t=r.when(forgeOptions),n=[this._forgeRequester,void 0],angular.forEach(a,function(e){return(e.request||e.requestError)&&n.unshift(e.request,e.requestError),e.response||e.responseError?n.push(e.response,e.responseError):void 0});n.length;)i=n.shift(),o=n.shift(),t=t.then(i,o);return t.success=function(n){return t.then(function(r){return n(r.data,r.status,r.headers,e)}),t},t.error=function(n){return t["catch"](function(r){var t,o;return o=function(){try{return JSON.parse(r.data)}catch(e){return t=e,r.data}}(),n(o,r.status,r.headers,e)}),t},t}}}}}]),angular.module("ngForge").provider("$forgeIonicKeyboard",function(){"use strict";return{$get:["$injector","$q","$forge","$forgeLogger","ngForgeUtils",function(e,n,r,t,o){var i;return i={disableScroll:function(e,n){return t.info("$forgeIonicKeyboard.disableScroll("+e+")"),"function"==typeof n?n():void 0},hideKeyboardAccessoryBar:function(e,n){return t.info("$forgeIonicKeyboard.hideKeyboardAccessoryBar("+e+")"),"function"==typeof n?n():void 0},isKeyboardVisible:function(e){return t.info("$forgeIonicKeyboard.isKeyboardVisible"),"function"==typeof e?e():void 0},close:function(e){return t.info("$forgeIonicKeyboard.close"),"function"==typeof e?e():void 0}},o.liftObject(r.dummy?i:forge.ionic_keyboard)}]}}),angular.module("ngForge").provider("$forgeLaunchimage",function(){"use strict";return{$get:["$forge","ngForgeUtils",function(e,n){var r={hide:function(e,n){return e()}};return n.liftObject(e.dummy?r:forge.launchimage)}]}}),angular.module("ngForge").factory("$forgeLogger",["ngForgeUtils",function(e){var n,r,t,o,i,u;return window.forge&&window.forge.is&&window.forge.is.mobile()?(n=function(n){var r,t;return n=Array.prototype.slice.call(n),r=e.filter(n,function(e){return e&&e instanceof Error}),r&&r.length?t=r[0]:void 0},u=function(e){return Array.prototype.slice.call(e).toString()},o=[],r=function(e){return i("▾ "+e),o.push(e)},t=function(){return o.pop()},i=function(e,n,t){var o,i,u,a;for(null==t&&(t=forge.logging.log),u="",o=i=0,a=r.length;a>=0?a>=i:i>=a;o=a>=0?++i:--i)u+="| ";return forge.logging.log(""+u+e,n)},{log:function(){return i(u(arguments),n(arguments))},debug:function(){return i(u(arguments),n(arguments),forge.logging.debug)},info:function(){return i(u(arguments),n(arguments),forge.logging.info)},warn:function(){return i(u(arguments),n(arguments),forge.logging.warn)},error:function(){return i(u(arguments),n(arguments),forge.logging.error)},critical:function(){return i(u(arguments),n(arguments),forge.logging.critical)},group:r,groupCollapsed:r,groupEnd:t}):console}]),angular.module("ngForge").provider("$forgeMedia",function(){"use strict";return{$get:["$injector","$q","$forge","$forgeLogger","ngForgeUtils",function(e,n,r,t,o){var i;return i={playerDummy:{play:function(e){return"function"==typeof e?e():void 0}},createAudioPlayer:function(e,n,r){return t.info("create dummy player "+e),"function"==typeof n?n(this.playerDummy):void 0}},o.liftObject(r.dummy?i:forge.media)}]}}),angular.module("ngForge").provider("$forgeParse",function(){"use strict";return{$get:["$injector","$q","$forge","$forgeLogger","ngForgeUtils",function(e,n,r,t,o){var i;return i={dummyChannels:[""],badgeNumber:0,getBadgeNumber:function(e){e(this.badgeNumber)},setBadgeNumber:function(e,n){this.badgeNumber=e,n()},installationInfo:function(e){return t.info("parseDummy info"),e({id:-696969})},registerForNotifications:function(e,n){return e()},push:{subscribe:function(e,n,r){return t.info("subscribing to "+e),o.includes(this.dummyChannels,e)||this.dummyChannels.push(e),"function"==typeof n?n():void 0},unsubscribe:function(e,n,r){return t.info("unsubscribing from "+e),this.dummyChannels=o.without(this.dummyChannels,e),"function"==typeof n?n():void 0},subscribedChannels:function(e,n){return"function"==typeof e?e(this.dummyChannels):void 0}}},o.liftObject(r.dummy?i:forge.parse)}]}}),angular.module("ngForge").provider("$forgePayments",function(){"use strict";return{$get:["$forge","$forgeLogger","ngForgeUtils",function(e,n,r){var t={purchaseProduct:function(e,r,t){var o=this;return setTimeout(function(){o.transactionReceived.listeners.forEach(function(r){r({productId:e,purchaseState:"PURCHASED"},function(){n.info("Purchase Confirmed")})})},5e3),r()},startSubscription:function(e,n,r){return n()},restoreTransactions:function(e,n){return e()},consumePurchase:function(e,n,r){return n()},transactionReceived:{listeners:[],addListener:function(e){this.listeners.push(e)}}};return r.liftObject(e.dummy?t:forge.payments)}]}}),angular.module("ngForge").provider("$forgePlatform",function(){"use strinct";return{$get:["$injector","$q","$forge","ngForgeUtils",function(e,n,r,t){var o,i;return i={getModel:function(e,n){return e("X")},getVersion:function(e,n){return e("1")},getAPILevel:function(e,n){return e("1")},getManufacturer:function(e,n){return e("X")}},o=r.dummy?i:forge.platform,t.liftObject(o)}]}}),angular.module("ngForge").provider("$forgePrefs",function(){"use strict";return{$get:["$injector","$q","$window","$forge","$forgeLogger","ngForgeUtils",function(e,n,r,t,o,i){var u=this,a=function(e){return r.localStorage.setItem(u.prefsKey,JSON.stringify(e))},f=function(){var e;return e=r.localStorage.getItem(u.prefsKey),e&&(e=JSON.parse(e)),e||(e={},a(e)),e},c={get:function(e,n,r){var t;try{return"function"==typeof n?n(f()[e]):void 0}catch(i){t=i,o.error(t.message),"function"==typeof r&&r(t)}},set:function(e,n,r,t){var i,u;try{return u=f(),u[e]=n,a(u),"function"==typeof r?r():void 0}catch(c){return i=c,o.error(i.message),"function"==typeof t?t(i):void 0}},clear:function(e,n,r){var t,i;try{return i=f(),delete i[e],a(i),"function"==typeof n?n():void 0}catch(u){return t=u,o.error(t.message),"function"==typeof r?r(t):void 0}},clearAll:function(e,n){var r;try{return a({}),"function"==typeof e?e():void 0}catch(t){return r=t,o.error(r.message),"function"==typeof n?n(r):void 0}},keys:function(e,n){var r,t;try{return t=f(),e(Object.keys(t))}catch(i){return r=i,o.error(r.message),n(r)}}};return i.liftObject(t.dummy?c:forge.prefs)}],prefsKey:"ngStorage-prefs"}}),angular.module("ngForge").provider("$forgeSegmentio",function(){"use strict";return{$get:["$injector","$q","$forge","$forgeLogger","ngForgeUtils",function(e,n,r,t,o){var i;return i={identify:function(e,n,r,o){return t.debug("identify"),"function"==typeof r?r():void 0},track:function(e,n,r,o){return t.debug("track"),"function"==typeof r?r():void 0},screen:function(e,n,r,o){return t.debug("screen"),"function"==typeof r?r():void 0}},o.liftObject(r.dummy?i:forge.segmentio)}]}}),angular.module("ngForge").provider("$forgeSms",function(){"use strict";return{$get:["$injector","$q","$forge","$forgeLogger","ngForgeUtils",function(e,n,r,t,o){var i;return i={send:function(e,n,r){return t.debug("$forgeSms.send "+e.body+" to "+JSON.stringify(e.to)),"function"==typeof n?n():void 0}},o.liftObject(r.dummy?i:forge.sms)}]}}),angular.module("ngForge").factory("ngForgeUtils",["$q",function(e){"use strict";var n=[].slice,r={}.hasOwnProperty;return{funcTag:"[object Function]",genTag:"[object GeneratorFunction]",filter:function(e,n){var r,t,o,i;if(!e)return void 0;for(r=[],t=0,o=e.length;o>t;t++)i=e[t],n(i)&&r.push(i);return r},find:function(e,n){var r,t,o;if(!e)return void 0;for(r=0,t=e.length;t>r;r++)if(o=e[r],n(o))return o;return void 0},includes:function(e,n){var r,t,o;if(!e)return void 0;for(r=0,t=e.length;t>r;r++)if(o=e[r],o===n)return!0;return!1},isFunction:function(e){var n;return n=this.isObject(e)?Object.prototype.toString.call(e):"",n===this.funcTag||n===this.genTag},isObject:function(e){var n;return n=typeof e,"object"===n||"function"===n},lift:function(r,t){return function(){var o,i,u,a,f;return i=1<=arguments.length?n.call(arguments,0):[],u=e.defer(),f=function(){return arguments&&1===arguments.length?u.resolve(arguments[0]):u.resolve(arguments)},a=function(){return arguments&&1===arguments.length?u.reject(arguments[0]):u.reject(arguments)},o=i.concat([f,a]),t.apply(r,o),u.promise}},liftGlobalFn:function(e){return this.lift(null,e)},liftObject:function(e){var n,t,o;if(n={},!e)return n;for(t in e)r.call(e,t)&&(o=e[t],o=e[t],n[t]=this.isFunction(o)?n[t]=this.lift(e,o):this.isObject(o)?this.liftObject(o):o);return n},mapValues:function(e,n){var r,t,o,i,u;if(r={},!e)return r;for(u=Object.keys(e),t=0,i=u.length;i>t;t++)o=u[t],r[o]=n(e[o]);return r},pick:function(e,n){var r,t,o,i;if(!e)return e;for(r={},t=0,i=n.length;i>t;t++)o=n[t],r[o]=e[o];return r},safeClone:function(e){return e?JSON.parse(JSON.stringify(e)):void 0},without:function(e,n){var r,t,o,i;if(!e)return e;for(r=[],t=0,o=e.length;o>t;t++)i=e[t],i!==n&&r.push(i);return r}}}])}();